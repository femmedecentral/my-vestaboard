import { Vestaboard } from './vestaboard.js'
import 'core-js/actual/array/group.js'
import axios from 'axios'
import { mean } from 'mathjs'
import dayjs from 'dayjs'
import yahooFinance from 'yahoo-finance2'
import { Configuration as OpenAIConfig, OpenAIApi, ChatCompletionRequestMessageRoleEnum as Role } from 'openai'
import dotenv from 'dotenv'
dotenv.config()

const config = {
  chatApiParams: { model: 'gpt-3.5-turbo' },
  openAiApiKey: process.env.OPENAI_API_KEY,
  weather: {
    url: 'https://api.weather.gov/gridpoints/OKX/34,45/forecast/hourly' // Get this from https://api.weather.gov/points/40.9375,-73.9477
  },
  haikuPrompts: {
    regular: [
      {birthday: '21-Mar', prompt: "Write a haiku about a cute baby boy named Aidan. He loves his mom, his pet cat Tigri and red Pontiac Solstice."},
      {birthday: '21-Mar', prompt: "Write a haiku about a beautiful Bengal cat called Tigri. She likes to purr on us, bask in the sun and eat tuna."},
      {birthday: '5-Feb' , prompt: "Write a haiku about a beautiful woman named Nastassia. She likes to play with her little boy, Aidan and sleep with her husband."},
    ].map(({birthday, prompt}) => {
      const suffix = dayjs().format('DD-MMM') === birthday ? 'Today is their birthday!' :
        "You don't have to use all this information - just giving helpful tips."
      return prompt + ' ' + suffix + ' . Just respond with the haiku and nothing else.'
    }),
    special: {
      '14-Feb': "Today is Valentine's Day. Write a Haiku about a beautiful woman named Nastassia who loves her husband, Rick.",
      '8-Mar': "Today is Woman's Day. Write a Haiku about a beautiful woman named Nastassia.",
      '29-Aug': "Today is marriage anniversary of Rick and Nastassia. Write a haiku about them.",
      '21-Dec': "Today is wedding anniversary of Rick and Nastassia. Write a haiku about them."
    }
  },
  tickers: [
    {ticker: 'MSFT'},
    {ticker: 'AAPL'},
    {ticker: 'TSLA'},
    {ticker: 'META'},
    {ticker: 'AMZN'},
    {ticker: 'GOOGL'},
    {ticker: 'TSM', name: 'TSMC'},
    {ticker: 'BTC-USD', name: 'BTC'},
    {ticker: 'BAC', name: 'BOFA'},
    {ticker: 'BABA'},
    {ticker: '^GSPC', name: 'S&P'},
    {ticker: '^TYX', name: 'US30'},
  ]
}

const board = new Vestaboard({rwKey: null})

const openai = new OpenAIApi(new OpenAIConfig({apiKey: config.openAiApiKey}))

class Haiku {
  static idx = 0
  static nextPrompt = () => config.haikuPrompts.special[dayjs().format('DD-MMM')] ?? config.haikuPrompts.regular[(Haiku.idx = (Haiku.idx + 1)%(config.haikuPrompts.regular.length))]
  static generate = (prompt = Haiku.nextPrompt()) => openai
    .createChatCompletion(Object.assign(config.chatApiParams, {messages: [{role: Role.User, content: prompt}]}))
    .then(res => res.data.choices[0].message.content)
}

const weather = () => axios.get(config.weather.url)
  .then(res => res.data.properties.periods)
  .then(entries => entries
    .map(entry => Object.assign(entry, {dateTime: dayjs(entry.startTime)}))
    .filter(entry => entry.isDaytime && entry.dateTime.hour() > 10)
    .group(entry => entry.dateTime.format('YYYY-MM-DD'))
  )
  .then(daily => Object.entries(daily).map(([date, entries]) => ({
    date: dayjs(date),
    temperature: Math.round(mean(entries.map(e => e.temperature))),
    descriptions: entries.map(e => e.shortForecast)
  })))

const quote = ({ticker, name}) => yahooFinance.quote(ticker).then(quote => Object.assign(quote, {name: name ?? ticker}))

const jobs = [
  () => weather().then(forecast => board.renderWeather(forecast)),
  () => Haiku.generate().then(haiku => board.writeHaiku(haiku)),
  () => Promise.all(config.tickers.map(ticker => quote(ticker)))
]

const res = [{"language":"en-US","region":"US","quoteType":"EQUITY","typeDisp":"Equity","quoteSourceName":"Nasdaq Real Time Price","triggerable":true,"customPriceAlertConfidence":"HIGH","fiftyTwoWeekLow":213.43,"fiftyTwoWeekHigh":313.71,"earningsTimestamp":"2023-04-25T21:30:00.000Z","earningsTimestampStart":"2023-07-24T10:59:00.000Z","earningsTimestampEnd":"2023-07-28T12:00:00.000Z","trailingAnnualDividendRate":2.66,"trailingPE":33.947937,"trailingAnnualDividendYield":0.008551405,"epsTrailingTwelveMonths":9.22,"epsForward":10.92,"epsCurrentYear":9.67,"priceEpsCurrentYear":32.36815,"sharesOutstanding":7435489792,"bookValue":26.178,"fiftyDayAverage":286.1878,"fiftyDayAverageChange":26.812195,"fiftyDayAverageChangePercent":0.093687415,"twoHundredDayAverage":258.8639,"twoHundredDayAverageChange":54.13611,"twoHundredDayAverageChangePercent":0.20912963,"marketCap":2327308402688,"forwardPE":28.663004,"priceToBook":11.956605,"sourceInterval":15,"exchangeDataDelayedBy":0,"averageAnalystRating":"1.8 - Buy","tradeable":false,"cryptoTradeable":false,"currency":"USD","regularMarketChangePercent":0.6236747,"regularMarketPrice":313,"marketState":"REGULAR","exchange":"NMS","shortName":"Microsoft Corporation","longName":"Microsoft Corporation","messageBoardId":"finmb_21835","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","gmtOffSetMilliseconds":-14400000,"market":"us_market","esgPopulated":false,"firstTradeDateMilliseconds":"1986-03-13T14:30:00.000Z","priceHint":2,"regularMarketChange":1.9400024,"regularMarketTime":"2023-05-17T17:00:01.000Z","regularMarketDayHigh":313.14,"regularMarketDayRange":{"low":310.74,"high":313.14},"regularMarketDayLow":310.74,"regularMarketVolume":9975478,"regularMarketPreviousClose":311.06,"bid":313.02,"ask":313.02,"bidSize":11,"askSize":11,"fullExchangeName":"NasdaqGS","financialCurrency":"USD","regularMarketOpen":312.29,"averageDailyVolume3Month":28931365,"averageDailyVolume10Day":24027180,"fiftyTwoWeekLowChange":99.57001,"fiftyTwoWeekLowChangePercent":0.46652302,"fiftyTwoWeekRange":{"low":213.43,"high":313.71},"fiftyTwoWeekHighChange":-0.70999146,"fiftyTwoWeekHighChangePercent":-0.0022632095,"dividendDate":"2023-06-08T00:00:00.000Z","displayName":"Microsoft","symbol":"MSFT","name":"MSFT"},{"language":"en-US","region":"US","quoteType":"EQUITY","typeDisp":"Equity","quoteSourceName":"Nasdaq Real Time Price","triggerable":true,"customPriceAlertConfidence":"HIGH","fiftyTwoWeekLow":124.17,"fiftyTwoWeekHigh":176.15,"earningsTimestamp":"2023-05-04T21:00:00.000Z","earningsTimestampStart":"2023-07-26T20:00:00.000Z","earningsTimestampEnd":"2023-07-31T20:00:00.000Z","trailingAnnualDividendRate":0.92,"trailingPE":29.091524,"trailingAnnualDividendYield":0.005346661,"epsTrailingTwelveMonths":5.9,"epsForward":6.54,"epsCurrentYear":5.97,"priceEpsCurrentYear":28.75042,"sharesOutstanding":15728700416,"bookValue":3.953,"fiftyDayAverage":163.1642,"fiftyDayAverageChange":8.4758,"fiftyDayAverageChangePercent":0.051946443,"twoHundredDayAverage":151.96545,"twoHundredDayAverageChange":19.674545,"twoHundredDayAverageChangePercent":0.12946722,"marketCap":2699674255360,"forwardPE":26.244648,"priceToBook":43.420185,"sourceInterval":15,"exchangeDataDelayedBy":0,"averageAnalystRating":"2.0 - Buy","tradeable":false,"cryptoTradeable":false,"currency":"USD","regularMarketChangePercent":-0.2499029,"regularMarketPrice":171.64,"marketState":"REGULAR","exchange":"NMS","shortName":"Apple Inc.","longName":"Apple Inc.","messageBoardId":"finmb_24937","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","gmtOffSetMilliseconds":-14400000,"market":"us_market","esgPopulated":false,"firstTradeDateMilliseconds":"1980-12-12T14:30:00.000Z","priceHint":2,"regularMarketChange":-0.43000793,"regularMarketTime":"2023-05-17T17:00:00.000Z","regularMarketDayHigh":172.15,"regularMarketDayRange":{"low":170.422,"high":172.15},"regularMarketDayLow":170.422,"regularMarketVolume":26949381,"regularMarketPreviousClose":172.07,"bid":171.35,"ask":171.32,"bidSize":11,"askSize":9,"fullExchangeName":"NasdaqGS","financialCurrency":"USD","regularMarketOpen":171.71,"averageDailyVolume3Month":58153583,"averageDailyVolume10Day":58905230,"fiftyTwoWeekLowChange":47.47,"fiftyTwoWeekLowChangePercent":0.38229847,"fiftyTwoWeekRange":{"low":124.17,"high":176.15},"fiftyTwoWeekHighChange":-4.5099945,"fiftyTwoWeekHighChangePercent":-0.02560315,"dividendDate":"2023-05-18T00:00:00.000Z","displayName":"Apple","symbol":"AAPL","name":"AAPL"},{"language":"en-US","region":"US","quoteType":"EQUITY","typeDisp":"Equity","quoteSourceName":"Nasdaq Real Time Price","triggerable":true,"customPriceAlertConfidence":"HIGH","exchange":"NMS","shortName":"Tesla, Inc.","longName":"Tesla, Inc.","messageBoardId":"finmb_27444752","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","gmtOffSetMilliseconds":-14400000,"market":"us_market","esgPopulated":false,"currency":"USD","regularMarketChange":6.4599915,"regularMarketTime":"2023-05-17T17:00:01.000Z","regularMarketDayHigh":173.99,"regularMarketDayRange":{"low":167.19,"high":173.99},"regularMarketDayLow":167.19,"regularMarketVolume":86111942,"regularMarketPreviousClose":166.52,"bid":173.18,"ask":173.19,"bidSize":8,"askSize":10,"fullExchangeName":"NasdaqGS","financialCurrency":"USD","regularMarketOpen":168.41,"averageDailyVolume3Month":135598513,"averageDailyVolume10Day":110723150,"fiftyTwoWeekLowChange":71.17,"fiftyTwoWeekLowChangePercent":0.69904727,"fiftyTwoWeekRange":{"low":101.81,"high":314.66666},"fiftyTwoWeekHighChange":-141.68666,"fiftyTwoWeekHighChangePercent":-0.45027542,"fiftyTwoWeekLow":101.81,"fiftyTwoWeekHigh":314.66666,"earningsTimestamp":"2023-04-19T21:30:00.000Z","earningsTimestampStart":"2023-07-18T20:00:00.000Z","earningsTimestampEnd":"2023-07-24T20:00:00.000Z","trailingAnnualDividendRate":0,"trailingPE":51.482143,"trailingAnnualDividendYield":0,"epsTrailingTwelveMonths":3.36,"epsForward":4.88,"epsCurrentYear":3.45,"priceEpsCurrentYear":50.13913,"sharesOutstanding":3169499904,"bookValue":15.164,"fiftyDayAverage":178.1864,"fiftyDayAverageChange":-5.2064056,"fiftyDayAverageChangePercent":-0.029218871,"twoHundredDayAverage":204.74129,"twoHundredDayAverageChange":-31.761292,"twoHundredDayAverageChangePercent":-0.15512891,"marketCap":548260085760,"forwardPE":35.44672,"priceToBook":11.407281,"sourceInterval":15,"exchangeDataDelayedBy":0,"averageAnalystRating":"2.5 - Buy","tradeable":false,"cryptoTradeable":false,"marketState":"REGULAR","firstTradeDateMilliseconds":"2010-06-29T13:30:00.000Z","priceHint":2,"regularMarketChangePercent":3.8794086,"regularMarketPrice":172.98,"displayName":"Tesla","symbol":"TSLA","name":"TSLA"},{"language":"en-US","region":"US","quoteType":"EQUITY","typeDisp":"Equity","quoteSourceName":"Nasdaq Real Time Price","triggerable":true,"customPriceAlertConfidence":"HIGH","fiftyTwoWeekLow":88.09,"fiftyTwoWeekHigh":244.92,"earningsTimestamp":"2023-04-26T21:00:00.000Z","earningsTimestampStart":"2023-07-25T10:59:00.000Z","earningsTimestampEnd":"2023-07-31T12:00:00.000Z","trailingAnnualDividendRate":0,"trailingPE":29.694002,"trailingAnnualDividendYield":0,"epsTrailingTwelveMonths":8.17,"epsForward":14.55,"epsCurrentYear":11.7,"priceEpsCurrentYear":20.735044,"sharesOutstanding":2212150016,"bookValue":48.634,"fiftyDayAverage":214.044,"fiftyDayAverageChange":28.556,"fiftyDayAverageChangePercent":0.13341181,"twoHundredDayAverage":159.7106,"twoHundredDayAverageChange":82.889404,"twoHundredDayAverageChangePercent":0.5189975,"marketCap":621718339584,"forwardPE":16.67354,"priceToBook":4.98828,"sourceInterval":15,"exchangeDataDelayedBy":0,"ipoExpectedDate":"2022-06-09T00:00:00.000Z","prevName":"Facebook, Inc.","nameChangeDate":"2023-05-16T00:00:00.000Z","averageAnalystRating":"1.9 - Buy","tradeable":false,"cryptoTradeable":false,"currency":"USD","regularMarketChangePercent":1.5827814,"regularMarketPrice":242.6,"marketState":"REGULAR","exchange":"NMS","shortName":"Meta Platforms, Inc.","longName":"Meta Platforms, Inc.","messageBoardId":"finmb_20765463","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","gmtOffSetMilliseconds":-14400000,"market":"us_market","esgPopulated":false,"firstTradeDateMilliseconds":"2012-05-18T13:30:00.000Z","priceHint":2,"regularMarketChange":3.7799988,"regularMarketTime":"2023-05-17T16:59:58.000Z","regularMarketDayHigh":242.7084,"regularMarketDayRange":{"low":238.14,"high":242.7084},"regularMarketDayLow":238.14,"regularMarketVolume":11541715,"regularMarketPreviousClose":238.82,"bid":242.07,"ask":242.1,"bidSize":11,"askSize":9,"fullExchangeName":"NasdaqGS","financialCurrency":"USD","regularMarketOpen":238.45,"averageDailyVolume3Month":25991898,"averageDailyVolume10Day":20711600,"fiftyTwoWeekLowChange":154.51001,"fiftyTwoWeekLowChangePercent":1.7540017,"fiftyTwoWeekRange":{"low":88.09,"high":244.92},"fiftyTwoWeekHighChange":-2.319992,"fiftyTwoWeekHighChangePercent":-0.009472448,"displayName":"Meta Platforms","symbol":"META","name":"META"},{"language":"en-US","region":"US","quoteType":"EQUITY","typeDisp":"Equity","quoteSourceName":"Nasdaq Real Time Price","triggerable":true,"customPriceAlertConfidence":"HIGH","marketState":"REGULAR","exchange":"NMS","shortName":"Amazon.com, Inc.","longName":"Amazon.com, Inc.","messageBoardId":"finmb_18749","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","market":"us_market","currency":"USD","gmtOffSetMilliseconds":-14400000,"esgPopulated":false,"regularMarketChangePercent":1.4373873,"regularMarketPrice":115.03,"firstTradeDateMilliseconds":"1997-05-15T13:30:00.000Z","priceHint":2,"regularMarketChange":1.6299973,"regularMarketTime":"2023-05-17T17:00:00.000Z","regularMarketDayHigh":115.83,"regularMarketDayRange":{"low":114.225,"high":115.83},"regularMarketDayLow":114.225,"regularMarketVolume":36841256,"regularMarketPreviousClose":113.4,"bid":114.71,"ask":114.72,"bidSize":11,"askSize":8,"fullExchangeName":"NasdaqGS","financialCurrency":"USD","regularMarketOpen":114.89,"averageDailyVolume3Month":60384686,"averageDailyVolume10Day":58849490,"fiftyTwoWeekLowChange":33.6,"averageAnalystRating":"1.8 - Buy","tradeable":false,"cryptoTradeable":false,"fiftyTwoWeekLowChangePercent":0.41262433,"fiftyTwoWeekRange":{"low":81.43,"high":146.57},"fiftyTwoWeekHighChange":-31.540009,"fiftyTwoWeekHighChangePercent":-0.21518733,"fiftyTwoWeekLow":81.43,"fiftyTwoWeekHigh":146.57,"earningsTimestamp":"2023-04-27T21:30:00.000Z","earningsTimestampStart":"2023-07-26T10:59:00.000Z","earningsTimestampEnd":"2023-07-31T12:00:00.000Z","trailingAnnualDividendRate":0,"trailingPE":280.56097,"trailingAnnualDividendYield":0,"epsTrailingTwelveMonths":0.41,"epsForward":2.54,"epsCurrentYear":1.56,"priceEpsCurrentYear":73.73718,"sharesOutstanding":10260400128,"bookValue":15.064,"fiftyDayAverage":101.9958,"fiftyDayAverageChange":13.034203,"fiftyDayAverageChangePercent":0.12779157,"twoHundredDayAverage":106.0707,"twoHundredDayAverageChange":8.959297,"twoHundredDayAverageChangePercent":0.08446533,"marketCap":1180253814784,"forwardPE":45.287403,"priceToBook":7.636086,"sourceInterval":15,"exchangeDataDelayedBy":0,"displayName":"Amazon.com","symbol":"AMZN","name":"AMZN"},{"language":"en-US","region":"US","quoteType":"EQUITY","typeDisp":"Equity","quoteSourceName":"Nasdaq Real Time Price","triggerable":true,"customPriceAlertConfidence":"HIGH","marketState":"REGULAR","currency":"USD","exchange":"NMS","shortName":"Alphabet Inc.","longName":"Alphabet Inc.","messageBoardId":"finmb_29096","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","gmtOffSetMilliseconds":-14400000,"market":"us_market","esgPopulated":false,"firstTradeDateMilliseconds":"2004-08-19T13:30:00.000Z","regularMarketChangePercent":0.6693962,"regularMarketPrice":120.31,"priceHint":2,"regularMarketChange":0.7999954,"regularMarketTime":"2023-05-17T17:00:00.000Z","regularMarketDayHigh":120.385,"regularMarketDayRange":{"low":118.89,"high":120.385},"regularMarketDayLow":118.89,"regularMarketVolume":14325501,"regularMarketPreviousClose":119.51,"bid":119.97,"ask":119.97,"bidSize":9,"askSize":10,"fullExchangeName":"NasdaqGS","financialCurrency":"USD","regularMarketOpen":119.61,"averageDailyVolume3Month":35345990,"averageDailyVolume10Day":39909120,"fiftyTwoWeekLowChange":36.97,"fiftyTwoWeekLowChangePercent":0.44360456,"fiftyTwoWeekRange":{"low":83.34,"high":122.43},"fiftyTwoWeekHighChange":-2.1200027,"fiftyTwoWeekHighChangePercent":-0.01731604,"fiftyTwoWeekLow":83.34,"fiftyTwoWeekHigh":122.43,"earningsTimestamp":"2023-04-25T21:00:00.000Z","earningsTimestampStart":"2023-07-24T20:00:00.000Z","earningsTimestampEnd":"2023-07-28T20:00:00.000Z","trailingAnnualDividendRate":0,"trailingPE":26.975336,"trailingAnnualDividendYield":0,"epsTrailingTwelveMonths":4.46,"epsForward":6.28,"epsCurrentYear":5.34,"priceEpsCurrentYear":22.52996,"sharesOutstanding":5941000192,"bookValue":20.507,"fiftyDayAverage":104.3582,"fiftyDayAverageChange":15.9517975,"fiftyDayAverageChangePercent":0.1528562,"twoHundredDayAverage":100.5641,"twoHundredDayAverageChange":19.745895,"twoHundredDayAverageChangePercent":0.19635133,"marketCap":1530307018752,"forwardPE":19.157642,"priceToBook":5.866777,"sourceInterval":15,"exchangeDataDelayedBy":0,"averageAnalystRating":"1.8 - Buy","tradeable":false,"cryptoTradeable":false,"symbol":"GOOGL","name":"GOOGL"},{"language":"en-US","region":"US","quoteType":"EQUITY","typeDisp":"Equity","quoteSourceName":"Nasdaq Real Time Price","triggerable":true,"customPriceAlertConfidence":"HIGH","marketState":"REGULAR","exchange":"NYQ","shortName":"Taiwan Semiconductor Manufactur","longName":"Taiwan Semiconductor Manufacturing Company Limited","messageBoardId":"finmb_380075","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","market":"us_market","currency":"USD","gmtOffSetMilliseconds":-14400000,"esgPopulated":false,"regularMarketChangePercent":6.1015434,"regularMarketPrice":91.12,"firstTradeDateMilliseconds":"1997-10-09T13:30:00.000Z","priceHint":2,"regularMarketChange":5.2400055,"regularMarketTime":"2023-05-17T17:00:00.000Z","regularMarketDayHigh":91.195,"regularMarketDayRange":{"low":88.09,"high":91.195},"regularMarketDayLow":88.09,"regularMarketVolume":12123025,"regularMarketPreviousClose":85.88,"bid":90.73,"ask":90.74,"bidSize":8,"askSize":9,"fullExchangeName":"NYSE","financialCurrency":"TWD","regularMarketOpen":88.3,"averageDailyVolume3Month":9746710,"averageDailyVolume10Day":7657230,"fiftyTwoWeekLowChange":31.690002,"averageAnalystRating":"1.7 - Buy","tradeable":false,"cryptoTradeable":false,"fiftyTwoWeekLowChangePercent":0.5332324,"fiftyTwoWeekRange":{"low":59.43,"high":98.99},"fiftyTwoWeekHighChange":-7.869995,"fiftyTwoWeekHighChangePercent":-0.07950293,"fiftyTwoWeekLow":59.43,"fiftyTwoWeekHigh":98.99,"dividendDate":"2023-10-12T00:00:00.000Z","trailingAnnualDividendRate":11.25,"trailingPE":14.579201,"trailingAnnualDividendYield":0.13099675,"epsTrailingTwelveMonths":6.25,"epsForward":6.38,"epsCurrentYear":5.15,"priceEpsCurrentYear":17.693205,"sharesOutstanding":5186409984,"bookValue":70.999374,"fiftyDayAverage":87.8514,"fiftyDayAverageChange":3.2686005,"fiftyDayAverageChangePercent":0.037206013,"twoHundredDayAverage":82.0966,"twoHundredDayAverageChange":9.023399,"twoHundredDayAverageChangePercent":0.10991197,"marketCap":472585699328,"forwardPE":14.282132,"priceToBook":1.2833916,"sourceInterval":15,"exchangeDataDelayedBy":0,"displayName":"Taiwan Semiconductor Manufacturing Company","symbol":"TSM","name":"TSMC"},{"language":"en-US","region":"US","quoteType":"CRYPTOCURRENCY","typeDisp":"Cryptocurrency","quoteSourceName":"CoinMarketCap","triggerable":true,"customPriceAlertConfidence":"HIGH","currency":"USD","volumeAllCurrencies":13161477120,"fromCurrency":"BTC","toCurrency":"USD=X","coinMarketCapLink":"https://coinmarketcap.com/currencies/bitcoin","regularMarketChange":-155.98438,"regularMarketTime":"2023-05-17T16:58:00.000Z","regularMarketDayHigh":27223.074,"regularMarketDayRange":{"low":26602.809,"high":27223.074},"regularMarketDayLow":26602.809,"regularMarketVolume":13161477120,"regularMarketPreviousClose":27023.729,"fullExchangeName":"CCC","regularMarketOpen":27023.729,"averageDailyVolume3Month":21769390353,"averageDailyVolume10Day":14840632253,"startDate":"2010-07-13T00:00:00.000Z","coinImageUrl":"https://s2.coinmarketcap.com/static/img/coins/64x64/1.png","logoUrl":"https://s2.coinmarketcap.com/static/img/coins/64x64/1.png","fiftyTwoWeekLowChange":11330.734,"fiftyTwoWeekLowChangePercent":0.7263735,"fiftyTwoWeekRange":{"low":15599.047,"high":32249.863},"fiftyTwoWeekHighChange":-5320.082,"fiftyTwoWeekHighChangePercent":-0.16496448,"fiftyTwoWeekLow":15599.047,"fiftyTwoWeekHigh":32249.863,"twoHundredDayAverageChangePercent":0.20053214,"exchange":"CCC","shortName":"Bitcoin USD","longName":"Bitcoin USD","messageBoardId":"finmb_BTC_CCC","exchangeTimezoneName":"UTC","exchangeTimezoneShortName":"UTC","gmtOffSetMilliseconds":0,"market":"ccc_market","esgPopulated":false,"firstTradeDateMilliseconds":"2014-09-17T00:00:00.000Z","priceHint":2,"circulatingSupply":19376206,"lastMarket":"CoinMarketCap","volume24Hr":13161477120,"marketState":"REGULAR","regularMarketChangePercent":-0.5758959,"regularMarketPrice":26929.781,"tradeable":false,"cryptoTradeable":true,"fiftyDayAverage":28482.012,"fiftyDayAverageChange":-1552.2305,"fiftyDayAverageChangePercent":-0.054498624,"twoHundredDayAverage":22431.537,"twoHundredDayAverageChange":4498.244,"marketCap":521797009408,"sourceInterval":15,"exchangeDataDelayedBy":0,"symbol":"BTC-USD","name":"BTC"},{"language":"en-US","region":"US","quoteType":"EQUITY","typeDisp":"Equity","quoteSourceName":"Nasdaq Real Time Price","triggerable":true,"customPriceAlertConfidence":"HIGH","currency":"USD","marketState":"REGULAR","regularMarketChange":1.1199989,"regularMarketTime":"2023-05-17T17:00:01.000Z","regularMarketChangePercent":4.093563,"regularMarketPrice":28.48,"exchange":"NYQ","shortName":"Bank of America Corporation","longName":"Bank of America Corporation","messageBoardId":"finmb_19049","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","gmtOffSetMilliseconds":-14400000,"market":"us_market","esgPopulated":false,"firstTradeDateMilliseconds":"1973-02-21T14:30:00.000Z","priceHint":2,"regularMarketDayHigh":28.525,"regularMarketDayRange":{"low":27.75,"high":28.525},"regularMarketDayLow":27.75,"regularMarketVolume":29568714,"regularMarketPreviousClose":27.36,"bid":28.35,"ask":28.37,"bidSize":13,"askSize":29,"fullExchangeName":"NYSE","financialCurrency":"USD","regularMarketOpen":27.735,"averageDailyVolume3Month":63787685,"averageDailyVolume10Day":43927400,"fiftyTwoWeekLowChange":2.1599998,"fiftyTwoWeekLowChangePercent":0.082066864,"fiftyTwoWeekRange":{"low":26.32,"high":38.6},"fiftyTwoWeekHighChange":-10.119999,"fiftyTwoWeekHighChangePercent":-0.26217616,"fiftyTwoWeekLow":26.32,"fiftyTwoWeekHigh":38.6,"dividendDate":"2023-06-30T00:00:00.000Z","earningsTimestamp":"2023-07-18T12:30:00.000Z","earningsTimestampStart":"2023-07-18T12:30:00.000Z","earningsTimestampEnd":"2023-07-18T12:30:00.000Z","trailingAnnualDividendRate":0.87,"trailingPE":8.656535,"trailingAnnualDividendYield":0.031798244,"twoHundredDayAverageChangePercent":-0.13596562,"epsTrailingTwelveMonths":3.29,"epsForward":3.36,"epsCurrentYear":3.42,"priceEpsCurrentYear":8.327485,"sharesOutstanding":7969149952,"bookValue":31.584,"fiftyDayAverage":28.6468,"fiftyDayAverageChange":-0.16679955,"fiftyDayAverageChangePercent":-0.005822624,"twoHundredDayAverage":32.96165,"twoHundredDayAverageChange":-4.4816513,"marketCap":226961391616,"forwardPE":8.476191,"priceToBook":0.9017224,"sourceInterval":15,"exchangeDataDelayedBy":0,"averageAnalystRating":"2.4 - Buy","tradeable":false,"cryptoTradeable":false,"displayName":"Bank of America","symbol":"BAC","name":"BOFA"},{"language":"en-US","region":"US","quoteType":"EQUITY","typeDisp":"Equity","quoteSourceName":"Nasdaq Real Time Price","triggerable":true,"customPriceAlertConfidence":"HIGH","currency":"USD","marketState":"REGULAR","exchange":"NYQ","shortName":"Alibaba Group Holding Limited","longName":"Alibaba Group Holding Limited","messageBoardId":"finmb_42083601","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","gmtOffSetMilliseconds":-14400000,"market":"us_market","esgPopulated":false,"regularMarketChangePercent":1.9828689,"regularMarketPrice":90.52,"firstTradeDateMilliseconds":"2014-09-19T13:30:00.000Z","priceHint":2,"regularMarketChange":1.7599945,"regularMarketTime":"2023-05-17T16:59:56.000Z","regularMarketDayHigh":91.05,"regularMarketDayRange":{"low":88.01,"high":91.05},"regularMarketDayLow":88.01,"regularMarketVolume":17437100,"regularMarketPreviousClose":88.76,"bid":90.52,"ask":90.54,"bidSize":12,"askSize":9,"fullExchangeName":"NYSE","financialCurrency":"CNY","regularMarketOpen":88.46,"averageDailyVolume3Month":25176276,"averageDailyVolume10Day":19571680,"fiftyTwoWeekLowChange":32.51,"fiftyTwoWeekLowChangePercent":0.56042063,"fiftyTwoWeekRange":{"low":58.01,"high":125.84},"fiftyTwoWeekHighChange":-35.32,"fiftyTwoWeekHighChangePercent":-0.2806739,"fiftyTwoWeekLow":58.01,"fiftyTwoWeekHigh":125.84,"earningsTimestamp":"2023-05-18T11:30:00.000Z","earningsTimestampStart":"2023-05-18T11:30:00.000Z","earningsTimestampEnd":"2023-05-18T11:30:00.000Z","trailingAnnualDividendRate":0,"trailingPE":49.73626,"trailingAnnualDividendYield":0,"epsTrailingTwelveMonths":1.82,"epsForward":8.7,"epsCurrentYear":7.71,"priceEpsCurrentYear":11.740596,"sharesOutstanding":2587500032,"bookValue":377.18,"fiftyDayAverage":89.0188,"fiftyDayAverageChange":1.5011978,"fiftyDayAverageChangePercent":0.016863829,"twoHundredDayAverage":89.57355,"twoHundredDayAverageChange":0.9464493,"twoHundredDayAverageChangePercent":0.010566169,"marketCap":234220486656,"forwardPE":10.404597,"priceToBook":0.23999152,"sourceInterval":15,"exchangeDataDelayedBy":0,"averageAnalystRating":"1.8 - Buy","tradeable":false,"cryptoTradeable":false,"displayName":"Alibaba Group Holding","symbol":"BABA","name":"BABA"},{"language":"en-US","region":"US","quoteType":"INDEX","typeDisp":"Index","quoteSourceName":"Free Realtime Quote","triggerable":true,"customPriceAlertConfidence":"HIGH","marketState":"REGULAR","exchange":"SNP","shortName":"S&P 500","longName":"S&P 500","messageBoardId":"finmb_INDEXGSPC","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","market":"us_market","currency":"USD","gmtOffSetMilliseconds":-14400000,"esgPopulated":false,"regularMarketChangePercent":0.999302,"regularMarketPrice":4150.97,"firstTradeDateMilliseconds":"1927-12-30T14:30:00.000Z","priceHint":2,"regularMarketChange":41.070312,"regularMarketTime":"2023-05-17T17:00:01.000Z","regularMarketDayHigh":4152.72,"regularMarketDayRange":{"low":4113.62,"high":4152.72},"regularMarketDayLow":4113.62,"regularMarketVolume":1103687000,"regularMarketPreviousClose":4109.9,"bid":4150.08,"ask":4151.55,"bidSize":0,"askSize":0,"fullExchangeName":"SNP","regularMarketOpen":4122.85,"averageDailyVolume3Month":4267338000,"averageDailyVolume10Day":3936482000,"fiftyTwoWeekLowChange":659.39014,"tradeable":false,"cryptoTradeable":false,"fiftyTwoWeekLowChangePercent":0.1888515,"fiftyTwoWeekRange":{"low":3491.58,"high":4325.28},"fiftyTwoWeekHighChange":-174.30957,"fiftyTwoWeekHighChangePercent":-0.040300183,"fiftyTwoWeekLow":3491.58,"fiftyTwoWeekHigh":4325.28,"fiftyDayAverage":4060.5884,"fiftyDayAverageChange":90.381836,"fiftyDayAverageChangePercent":0.02225831,"twoHundredDayAverage":3974.828,"twoHundredDayAverageChange":176.14233,"twoHundredDayAverageChangePercent":0.044314455,"sourceInterval":15,"exchangeDataDelayedBy":0,"symbol":"^GSPC","name":"S&P"},{"language":"en-US","region":"US","quoteType":"INDEX","typeDisp":"Index","triggerable":false,"customPriceAlertConfidence":"LOW","regularMarketChangePercent":-0.051662493,"regularMarketPrice":3.869,"exchange":"NYB","shortName":"Treasury Yield 30 Years","longName":"Treasury Yield 30 Years","messageBoardId":"finmb_INDEXTYX","exchangeTimezoneName":"America/New_York","exchangeTimezoneShortName":"EDT","gmtOffSetMilliseconds":-14400000,"market":"us24_market","esgPopulated":false,"marketState":"REGULAR","currency":"USD","firstTradeDateMilliseconds":"1977-02-15T05:00:00.000Z","priceHint":4,"regularMarketChange":-0.001999855,"regularMarketTime":"2023-05-17T16:44:55.000Z","regularMarketDayHigh":3.874,"regularMarketDayRange":{"low":3.8349998,"high":3.874},"regularMarketDayLow":3.8349998,"regularMarketPreviousClose":3.8709998,"bid":0,"ask":0,"bidSize":0,"askSize":0,"fullExchangeName":"ICE Futures","regularMarketOpen":3.8349998,"averageDailyVolume3Month":0,"averageDailyVolume10Day":0,"fiftyTwoWeekLowChange":1.0139999,"fiftyTwoWeekLowChangePercent":0.35516635,"fiftyTwoWeekRange":{"low":2.855,"high":4.425},"fiftyTwoWeekHighChange":-0.55600023,"fiftyTwoWeekHighChangePercent":-0.12564977,"fiftyTwoWeekLow":2.855,"fiftyTwoWeekHigh":4.425,"fiftyDayAverage":3.7298,"fiftyDayAverageChange":0.13919997,"fiftyDayAverageChangePercent":0.037321027,"twoHundredDayAverage":3.697315,"twoHundredDayAverageChange":0.17168498,"twoHundredDayAverageChangePercent":0.046435043,"sourceInterval":30,"exchangeDataDelayedBy":10,"tradeable":false,"cryptoTradeable":false,"symbol":"^TYX","name":"US30"}]



